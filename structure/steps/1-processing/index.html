
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../data/plan_details/">
      
      
        <link rel="next" href="../2-forecast-prep/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.9">
    
    
      
        <title>1. Data Processing - Five Year Plan Analysis</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-the-data-processing-pipeline" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Five Year Plan Analysis" class="md-header__button md-logo" aria-label="Five Year Plan Analysis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Five Year Plan Analysis
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1. Data Processing
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Five Year Plan Analysis" class="md-nav__button md-logo" aria-label="Five Year Plan Analysis" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Five Year Plan Analysis
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../install/" class="md-nav__link">
        Install
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/interactive/" class="md-nav__link">
        Working Interactively
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/updates/" class="md-nav__link">
        Annual Updates
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          The Code Structure
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          The Code Structure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          The data/ folder
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          The data/ folder
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/plan_details/" class="md-nav__link">
        Plan Details
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          Analysis Steps
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Analysis Steps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          1. Data Processing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        1. Data Processing
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-the-pipeline" class="md-nav__link">
    Running the Pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#steps" class="md-nav__link">
    Steps
  </a>
  
    <nav class="md-nav" aria-label="Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-download-indicators" class="md-nav__link">
    Step 1: Download indicators
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-impute-cbo-values" class="md-nav__link">
    Step 2: Impute CBO values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-get-quarterly-averages" class="md-nav__link">
    Step 3: Get quarterly averages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-combine-indicators-and-tax-bases" class="md-nav__link">
    Step 4: Combine indicators and tax bases
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-seasonally-adjust-features" class="md-nav__link">
    Step 5: Seasonally adjust features
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-calculate-stationary-guide" class="md-nav__link">
    Step 6: Calculate stationary guide
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-final-unscaled-features" class="md-nav__link">
    Step 7: Final unscaled features
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8-final-scaled-features" class="md-nav__link">
    Step 8: Final scaled features
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2-forecast-prep/" class="md-nav__link">
        2. Forecast Prep
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../3-exploratory/" class="md-nav__link">
        3. Exploratory Modeling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4-forecast/" class="md-nav__link">
        4. Forecasting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-the-pipeline" class="md-nav__link">
    Running the Pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#steps" class="md-nav__link">
    Steps
  </a>
  
    <nav class="md-nav" aria-label="Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-download-indicators" class="md-nav__link">
    Step 1: Download indicators
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-impute-cbo-values" class="md-nav__link">
    Step 2: Impute CBO values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-get-quarterly-averages" class="md-nav__link">
    Step 3: Get quarterly averages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-combine-indicators-and-tax-bases" class="md-nav__link">
    Step 4: Combine indicators and tax bases
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-seasonally-adjust-features" class="md-nav__link">
    Step 5: Seasonally adjust features
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-calculate-stationary-guide" class="md-nav__link">
    Step 6: Calculate stationary guide
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-final-unscaled-features" class="md-nav__link">
    Step 7: Final unscaled features
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-8-final-scaled-features" class="md-nav__link">
    Step 8: Final scaled features
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="1-the-data-processing-pipeline">1. The Data Processing Pipeline</h1>
<p>The analysis code begins with the data processing pipeline. This pipeline
starts by downloading the latest economic indicators and ends by outputting a
set of features that can be input into the VAR modeling pipeline. </p>
<p>Its main purpose is to identify the series of transformations that will make
each time series indicator stationary so that the indicators are suitable for
use in a vector autoregression.</p>
<p>The code for the pipeline is available at:</p>
<p><code>src/fyp_analysis/pipelines/data_processing/</code>
(<a href="https://github.com/PhilaController/five-year-plan-analysis/tree/main/src/fyp_analysis/pipelines/data_processing">link</a>)</p>
<h2 id="running-the-pipeline">Running the Pipeline</h2>
<p>To run the pipeline, execute:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>poetry run fyp-analysis-run --pipeline dp
</span></code></pre></div>
<p>where <code>dp</code> is short for "data processing".</p>
<h2 id="parameters">Parameters</h2>
<p>The parameters for the data processing pipeline can be set in the file:
<code>conf/base/parameters/data_processing.yml</code>
(<a href="https://github.com/PhilaController/five-year-plan-analysis/blob/main/conf/base/parameters/data_processing.yml">link</a>).
The parameters are:</p>
<ul>
<li><strong>fresh_indicators</strong>: whether to download fresh economic indicators</li>
<li><strong>seasonal_adjustments</strong>: the names of the columns to apply seasonal
  adjustments to</li>
<li><strong>min_feature_year</strong>: the minimum year to trim the indicators to</li>
</ul>
<h2 id="steps">Steps</h2>
<p>This section outlines the steps (also called nodes) in the data processing
pipeline. The steps are defined in the
<a href="https://github.com/PhiladelphiaController/five-year-plan-analysis/blob/main/src/fyp_analysis/pipelines/data_processing/pipeline.py#L15">src/fyp_analysis/pipelines/data_processing/pipeline.py
file</a>.
In this file, we define the function to run for each step, as well as the
inputs and outputs of each function.</p>
<p>This pipeline will download the latest version of a set of economic indicators,
perform various transformations, and output a set of features suitable to be
used as input to the <a href="../../modeling/overview">modeling pipeline</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure you have properly set up your local API credentials before running
this pipeline. Otherwise, you won't be able to download all of the necessary indicators. 
See the <a href="../../../install/#set-up-your-api-credentials">setup instructions</a> for more information.</p>
</div>
<p>In python, the pipeline is defined as follows:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">def</span> <span class="nf">create_pipeline</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="k">return</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>        <span class="p">[</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>            <span class="n">node</span><span class="p">(</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>                <span class="n">func</span><span class="o">=</span><span class="n">get_economic_indicators</span><span class="p">,</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>                <span class="n">inputs</span><span class="o">=</span><span class="s2">&quot;params:fresh_indicators&quot;</span><span class="p">,</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>                <span class="n">outputs</span><span class="o">=</span><span class="s2">&quot;economic_indicators&quot;</span><span class="p">,</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;economic_indicators_node&quot;</span><span class="p">,</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>            <span class="p">),</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>            <span class="n">node</span><span class="p">(</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>                <span class="n">func</span><span class="o">=</span><span class="n">get_quarterly_averages</span><span class="p">,</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>                <span class="n">inputs</span><span class="o">=</span><span class="s2">&quot;economic_indicators&quot;</span><span class="p">,</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>                <span class="n">outputs</span><span class="o">=</span><span class="s2">&quot;quarterly_features_raw&quot;</span><span class="p">,</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;quarterly_features_raw_node&quot;</span><span class="p">,</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>            <span class="p">),</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>            <span class="n">node</span><span class="p">(</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>                <span class="n">func</span><span class="o">=</span><span class="n">impute_cbo_values</span><span class="p">,</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>                <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>                    <span class="s2">&quot;quarterly_features_raw&quot;</span><span class="p">,</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>                    <span class="s2">&quot;params:plan_start_year&quot;</span><span class="p">,</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>                    <span class="s2">&quot;params:cbo_forecast_date&quot;</span><span class="p">,</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>                <span class="p">],</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>                <span class="n">outputs</span><span class="o">=</span><span class="s2">&quot;quarterly_features_cbo_imputed&quot;</span><span class="p">,</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;impute_cbo_node&quot;</span><span class="p">,</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>            <span class="p">),</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>            <span class="n">node</span><span class="p">(</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>                <span class="n">func</span><span class="o">=</span><span class="n">combine_features_and_bases</span><span class="p">,</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>                <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;quarterly_features_cbo_imputed&quot;</span><span class="p">,</span> <span class="s2">&quot;plan_details&quot;</span><span class="p">],</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>                <span class="n">outputs</span><span class="o">=</span><span class="s2">&quot;features_and_bases&quot;</span><span class="p">,</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;combine_features_bases_node&quot;</span><span class="p">,</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>            <span class="p">),</span>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>            <span class="n">node</span><span class="p">(</span>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>                <span class="n">func</span><span class="o">=</span><span class="n">seasonally_adjust_features</span><span class="p">,</span>
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>                <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;features_and_bases&quot;</span><span class="p">,</span> <span class="s2">&quot;params:seasonal_adjustments&quot;</span><span class="p">],</span>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>                <span class="n">outputs</span><span class="o">=</span><span class="s2">&quot;features_and_bases_sa&quot;</span><span class="p">,</span>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;seasonal_adjustment_node&quot;</span><span class="p">,</span>
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>            <span class="p">),</span>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>            <span class="n">node</span><span class="p">(</span>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>                <span class="n">func</span><span class="o">=</span><span class="n">get_stationary_guide</span><span class="p">,</span>
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>                <span class="n">inputs</span><span class="o">=</span><span class="s2">&quot;features_and_bases_sa&quot;</span><span class="p">,</span>
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>                <span class="n">outputs</span><span class="o">=</span><span class="s2">&quot;stationary_guide&quot;</span><span class="p">,</span>
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stationary_guide_node&quot;</span><span class="p">,</span>
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>            <span class="p">),</span>
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>            <span class="n">node</span><span class="p">(</span>
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>                <span class="n">func</span><span class="o">=</span><span class="n">get_final_unscaled_features</span><span class="p">,</span>
</span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>                <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;features_and_bases_sa&quot;</span><span class="p">,</span> <span class="s2">&quot;params:min_feature_year&quot;</span><span class="p">],</span>
</span><span id="__span-1-47"><a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>                <span class="n">outputs</span><span class="o">=</span><span class="s2">&quot;final_unscaled_features&quot;</span><span class="p">,</span>
</span><span id="__span-1-48"><a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;final_unscaled_features_node&quot;</span><span class="p">,</span>
</span><span id="__span-1-49"><a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>            <span class="p">),</span>
</span><span id="__span-1-50"><a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a>            <span class="n">node</span><span class="p">(</span>
</span><span id="__span-1-51"><a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a>                <span class="n">func</span><span class="o">=</span><span class="n">get_final_scaled_features</span><span class="p">,</span>
</span><span id="__span-1-52"><a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a>                <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-1-53"><a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a>                    <span class="s2">&quot;final_unscaled_features&quot;</span><span class="p">,</span>
</span><span id="__span-1-54"><a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a>                    <span class="s2">&quot;stationary_guide&quot;</span><span class="p">,</span>
</span><span id="__span-1-55"><a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a>                <span class="p">],</span>
</span><span id="__span-1-56"><a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a>                <span class="n">outputs</span><span class="o">=</span><span class="s2">&quot;final_scaled_features&quot;</span><span class="p">,</span>
</span><span id="__span-1-57"><a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;final_scaled_features_node&quot;</span><span class="p">,</span>
</span><span id="__span-1-58"><a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a>            <span class="p">),</span>
</span><span id="__span-1-59"><a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a>        <span class="p">]</span>
</span><span id="__span-1-60"><a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a>    <span class="p">)</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Reminder</p>
<p>As described <a href="../../../usage/interactive">here</a>, if you are
working with IPython or in a Jupyter notebook, you can load any named
dataset (the inputs/outputs above) using the <code>catalog.load()</code> function. 
For example, to load the "economic_indicators" dataset (the output from step 1), use:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">indicators</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;economic_indicators&quot;</span><span class="p">)</span>
</span></code></pre></div>
</div>
<h3 id="step-1-download-indicators">Step 1: Download indicators</h3>
<ul>
<li><strong>Function</strong>: <code>get_economic_indicators()</code></li>
<li><strong>Purpose</strong>: Download the latest set of economic indicators and save them
  locally</li>
<li><strong>Inputs</strong>: <ul>
<li>Parameter: <code>fresh_indicators</code></li>
</ul>
</li>
<li><strong>Outputs:</strong> <ul>
<li>Dataset: <code>economic_indicators</code> in the <code>data/02_intermediate/</code> folder</li>
</ul>
</li>
</ul>
<p>Economic indicators are defined in the
<a href="https://github.com/PhilaController/five-year-plan-analysis/tree/main/src/fyp_analysis/pipelines/data_processing/indicators/sources">src/fyp_analysis/pipelines/data_processing/indicators/sources</a>
folder. Right now, there are various sources, including FRED, Quandl, CARTO
(Philadelphia open data), and Zillow, with a JSON file for each source that
lists the information necessary for download. New indicators can be added by
adding a new entry to the appropriate JSON file.</p>
<p>The current set of indicators includes the following:</p>
<table>
<thead>
<tr>
<th align="left">name</th>
<th align="left">description</th>
<th align="left">source</th>
<th align="left">frequency</th>
<th align="left">geography</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ActivityLicensesPhilly</td>
<td align="left">Commercial activity licenses for the City of Philadelphia</td>
<td align="left">carto</td>
<td align="left">monthly</td>
<td align="left">Philadelphia</td>
</tr>
<tr>
<td align="left">BizLicensesPhilly</td>
<td align="left">Business licenses for the City of Philadelphia</td>
<td align="left">carto</td>
<td align="left">monthly</td>
<td align="left">Philadelphia</td>
</tr>
<tr>
<td align="left">BuildingPermitsPhilly</td>
<td align="left">New construction permits for the City of Philadelphia</td>
<td align="left">carto</td>
<td align="left">monthly</td>
<td align="left">Philadelphia</td>
</tr>
<tr>
<td align="left">DeedTransfersPhilly</td>
<td align="left">Deed real estate transfers for the City of Philadelphia</td>
<td align="left">carto</td>
<td align="left">monthly</td>
<td align="left">Philadelphia</td>
</tr>
<tr>
<td align="left">10YearTreasury</td>
<td align="left">10-Year Treasury Constant Maturity Rate</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">3MonthTreasury</td>
<td align="left">3-Month Treasury Bill: Secondary Market Rate</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">AlcoholSales</td>
<td align="left">Retail Sales: Beer, Wine, and Liquor Stores</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">BuildingPermitsPhillyMSA</td>
<td align="left">New Private Housing Units Authorized by Building Permits for Philadelphia-Camden-Wilmington, PA-NJ-DE-MD (MSA)</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">CPIPhillyMSA</td>
<td align="left">Consumer Price Index for All Urban Consumers: All Items in Philadelphia-Camden-Wilmington, PA-NJ-DE-MD</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">CPIU</td>
<td align="left">Consumer Price Index for All Urban Consumers: All Items in U.S. City Average</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">CarSales</td>
<td align="left">Total Vehicle Sales</td>
<td align="left">fred</td>
<td align="left">daily</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">ConsumerConfidence</td>
<td align="left">Consumer Opinion Surveys: Confidence Indicators: Composite Indicators: OECD Indicator for the United States</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">ContinuedClaimsPA</td>
<td align="left">Continued Claims (Insured Unemployment) in Pennsylvania</td>
<td align="left">fred</td>
<td align="left">weekly</td>
<td align="left">state</td>
</tr>
<tr>
<td align="left">CorporateProfits</td>
<td align="left">Corporate Profits with Inventory Valuation Adjustment (IVA) and Capital Consumption Adjustment (CCAdj)</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">EconomicConditionsPhillyMSA</td>
<td align="left">Economic Conditions Index for Philadelphia-Camden-Wilmington, PA-NJ-DE-MD (MSA)</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">EmploymentCostIndex</td>
<td align="left">Employment Cost Index: Wages and Salaries: Private Industry Workers</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">FHFAHousePriceIndex</td>
<td align="left">Purchase Only House Price Index for the United States</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">FedFundsRate</td>
<td align="left">Effective Federal Funds Rate</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">GDP</td>
<td align="left">Gross Domestic Product</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">GDPPriceIndex</td>
<td align="left">Gross Domestic Product: Chain-type Price Index</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">GovtSocialBenefits</td>
<td align="left">Federal government current transfer payments: Government social benefits: to persons</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">HousePriceIndexPhillyMSA</td>
<td align="left">All-Transactions House Price Index for Philadelphia, PA (MSAD)</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">HousingStarts</td>
<td align="left">Housing Starts: Total: New Privately Owned Housing Units Started</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">HousingSupply</td>
<td align="left">Monthly Supply of Houses in the United States</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">InitialClaimsPA</td>
<td align="left">Initial Claims in Pennsylvania</td>
<td align="left">fred</td>
<td align="left">weekly</td>
<td align="left">state</td>
</tr>
<tr>
<td align="left">JobOpenings</td>
<td align="left">Job Openings: Total Nonfarm</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">ManufacturingHoursWorked</td>
<td align="left">Weekly Hours Worked: Manufacturing for the United States</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">NYCGasPrice</td>
<td align="left">Conventional Gasoline Prices: New York Harbor, Regular</td>
<td align="left">fred</td>
<td align="left">daily</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">NewManufacturingOrders</td>
<td align="left">Manufacturers' New Orders: Nondefense Capital Goods Excluding Aircraft</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">NonfarmEmployeesPhilly</td>
<td align="left">All Employees: Total Nonfarm in Philadelphia City, PA</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">Philadelphia</td>
</tr>
<tr>
<td align="left">NonfarmEmployeesPhillyMSA</td>
<td align="left">All Employees: Total Nonfarm in Philadelphia-Camden-Wilmington, PA-NJ-DE-MD (MSA)</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">NonfarmEmployment</td>
<td align="left">All Employees, Total Nonfarm</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">NonresidentialInvestment</td>
<td align="left">Private Nonresidential Fixed Investment</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">OilPriceWTI</td>
<td align="left">Crude Oil Prices: West Texas Intermediate (WTI) - Cushing, Oklahoma</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">PCE</td>
<td align="left">Personal Consumption Expenditures</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">PCEPriceIndex</td>
<td align="left">Personal Consumption Expenditures: Chain-type Price Index</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">PPI</td>
<td align="left">Producer Price Index for All Commodities</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">PersonalIncome</td>
<td align="left">Personal Income</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">PersonalIncomePhillyMSA</td>
<td align="left">Per Capita Personal Income in Philadelphia County/city, PA</td>
<td align="left">fred</td>
<td align="left">annual</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">PersonalSavingsRate</td>
<td align="left">Personal Savings Rate</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">PopulationPhilly</td>
<td align="left">Resident Population in Philadelphia County/city, PA</td>
<td align="left">fred</td>
<td align="left">annual</td>
<td align="left">Philadelphia</td>
</tr>
<tr>
<td align="left">PrimeEPOP</td>
<td align="left">Employment-Population Ratio</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">RealDisposablePersonalIncome</td>
<td align="left">Real Disposable Personal Income</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">RealGDP</td>
<td align="left">Real Gross Domestic Product</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">RealGDPPhillyMSA</td>
<td align="left">Total Real Gross Domestic Product for Philadelphia-Camden-Wilmington, PA-NJ-DE-MD</td>
<td align="left">fred</td>
<td align="left">annual</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">RealRetailFoodServiceSales</td>
<td align="left">Advance Real Retail and Food Services Sales</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">ResidentialInvestment</td>
<td align="left">Private Residential Fixed Investment</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">SahmRule</td>
<td align="left">Real-time Sahm Rule Recession Indicator</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">TotalBusinessSales</td>
<td align="left">Total Business Sales</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">UncertaintyIndex</td>
<td align="left">Economic Policy Uncertainty Index for United States</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">UnemploymentPhilly</td>
<td align="left">Unemployment Rate in Philadelphia County/City, PA</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">Philadelphia</td>
</tr>
<tr>
<td align="left">UnemploymentPhillyMSA</td>
<td align="left">Unemployment Rate in Philadelphia-Camden-Wilmington, PA-NJ-DE-MD</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">UnemploymentRate</td>
<td align="left">Unemployment Rate</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">Wage&amp;Salaries</td>
<td align="left">Compensation of Employees, Received: Wage and Salary Disbursements</td>
<td align="left">fred</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">WagesPhillyMSA</td>
<td align="left">Average Weekly Wages for Employees in Total Covered Establishments in Philadelphia-Camden-Wilmington, PA-NJ-DE-MD</td>
<td align="left">fred</td>
<td align="left">quarterly</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">WeeklyEconomicIndex</td>
<td align="left">Weekly Economic Index (Lewis-Mertens-Stock)</td>
<td align="left">fred</td>
<td align="left">weekly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">YieldCurve</td>
<td align="left">10-Year Treasury Constant Maturity Minus 2-Year Treasury Constant Maturity</td>
<td align="left">fred</td>
<td align="left">daily</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">SP500</td>
<td align="left">Monthly S&amp;P 500 Price</td>
<td align="left">quandl</td>
<td align="left">monthly</td>
<td align="left">national</td>
</tr>
<tr>
<td align="left">HousingInventoryPhillyMSA</td>
<td align="left">For-Sale Inventory (Smooth, All Homes, Monthly)</td>
<td align="left">zillow</td>
<td align="left">monthly</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">MeanDaysToSalePhillyMSA</td>
<td align="left">Mean Days to Pending (Smooth, All Homes, Monthly)</td>
<td align="left">zillow</td>
<td align="left">monthly</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">MedianHomeValuePhilly</td>
<td align="left">ZHVI All Homes (SFR, Condo/Co-op) Time Series</td>
<td align="left">zillow</td>
<td align="left">monthly</td>
<td align="left">Philadelphia</td>
</tr>
<tr>
<td align="left">MedianListPricePhillyMSA</td>
<td align="left">Median List Price (Smooth, All Homes, Monthly)</td>
<td align="left">zillow</td>
<td align="left">monthly</td>
<td align="left">Philadelphia MSA</td>
</tr>
<tr>
<td align="left">RentIndexPhillyMSA</td>
<td align="left">ZORI (Smoothed, Seasonally Adjusted} All Homes Plus Multifamily</td>
<td align="left">zillow</td>
<td align="left">monthly</td>
<td align="left">Philadelphia MSA</td>
</tr>
</tbody>
</table>
<h3 id="step-2-impute-cbo-values">Step 2: Impute CBO values</h3>
<ul>
<li><strong>Function</strong>: <code>impute_cbo_values()</code></li>
<li><strong>Purpose</strong>: Impute CBO forecast values for Q4 of the current fiscal year.</li>
<li><strong>Inputs</strong>: <ul>
<li>Dataset: <code>economic_indicators</code></li>
</ul>
</li>
<li><strong>Outputs:</strong> <ul>
<li>Dataset: <code>quarterly_features_raw</code> in the <code>data/02_intermediate/</code> folder</li>
</ul>
</li>
</ul>
<p>For economic indicators that CBO is projections for, this will impute the
forecast value for Q4 of the current fiscal year, where an actual value is
lacking.</p>
<h3 id="step-3-get-quarterly-averages">Step 3: Get quarterly averages</h3>
<ul>
<li><strong>Function</strong>: <code>get_quarterly_averages()</code></li>
<li><strong>Purpose</strong>: Get the quarterly averages of the indicators and remove any
  indicators with annual frequency.</li>
<li><strong>Inputs</strong>: <ul>
<li>Dataset: <code>quarterly_features_raw</code></li>
<li>Parameter: <code>plan_start_year</code></li>
<li>Parameter: <code>cbo_forecast_date</code></li>
</ul>
</li>
<li><strong>Outputs:</strong> <ul>
<li>Dataset: <code>quarterly_features_cbo_imputed</code> in the <code>data/02_intermediate/</code>
  folder</li>
</ul>
</li>
</ul>
<h3 id="step-4-combine-indicators-and-tax-bases">Step 4: Combine indicators and tax bases</h3>
<ul>
<li><strong>Function</strong>: <code>combine_features_and_bases()</code></li>
<li><strong>Purpose</strong>: Combine the economic indicator features and the tax base data
  into a single data frame.</li>
<li><strong>Inputs</strong>: <ul>
<li>Dataset: <code>quarterly_features_cbo_imputed</code></li>
<li>Dataset: <code>plan_details</code></li>
</ul>
</li>
<li><strong>Outputs:</strong> <ul>
<li>Dataset: <code>features_and_bases</code> in the <code>data/02_intermediate/</code> folder</li>
</ul>
</li>
</ul>
<h3 id="step-5-seasonally-adjust-features">Step 5: Seasonally adjust features</h3>
<ul>
<li><strong>Function</strong>: <code>seasonally_adjust_features()</code></li>
<li><strong>Purpose</strong>: Seasonally adjust the specified columns, using the <a href="https://www.statsmodels.org/dev/generated/statsmodels.tsa.seasonal.STL.html">LOESS
  functionality in
  statsmodels</a>.</li>
<li><strong>Inputs</strong>: <ul>
<li>Dataset: <code>features_and_bases</code></li>
<li>Parameter: <code>seasonal_adjustments</code></li>
</ul>
</li>
<li><strong>Outputs:</strong> <ul>
<li>Dataset: <code>features_and_bases_sa</code> in the <code>data/02_intermediate/</code> folder</li>
</ul>
</li>
</ul>
<h3 id="step-6-calculate-stationary-guide">Step 6: Calculate stationary guide</h3>
<ul>
<li><strong>Function</strong>: <code>get_stationary_guide()</code></li>
<li><strong>Purpose</strong>: Make the stationary guide, a spreadsheet which contains the
  instructions for making each feature stationary.</li>
<li><strong>Inputs</strong>: <ul>
<li>Dataset: <code>features_and_bases_sa</code></li>
</ul>
</li>
<li><strong>Outputs:</strong> <ul>
<li>Dataset: <code>stationary_guide</code> in the <code>data/02_intermediate/</code> folder</li>
</ul>
</li>
</ul>
<p>For each feature, the stationary guide contains the following information:</p>
<ul>
<li>Can we take the log of the variable (e.g., is it non-negative?)?</li>
<li>How many differences for stationary?</li>
<li>Should we normalize the data first?</li>
</ul>
<p>The spreadsheet is available in the <code>data/02_intermediate/</code> folder
<a href="https://github.com/PhilaController/five-year-plan-analysis/blob/main/data/02_intermediate/stationary_guide.xlsx">(link)</a>.</p>
<p>This step also creates the diagnostic stationary plots for all tax bases and
save them to <code>data / 02_intermediate / stationary_figures</code>. These figures test
the autocorrelation and partial autocorrelation of the time series. For
example, the stationary figure for the Wage Tax is:</p>
<p><img alt="Wage Tax stationary
Figure" src="https://github.com/PhilaController/five-year-plan-analysis/raw/main/data/02_intermediate/stationary_figures/WageBase.png" /></p>
<h3 id="step-7-final-unscaled-features">Step 7: Final unscaled features</h3>
<ul>
<li><strong>Function</strong>: <code>get_final_unscaled_features()</code></li>
<li><strong>Purpose</strong>: Get the final unscaled features to input into the modeling
pipeline. The only additional preprocessing performed in this step is trimming
to the specific minimum year for all features and tax bases.</li>
<li><strong>Inputs</strong>: <ul>
<li>Dataset: <code>features_and_bases_sa</code></li>
<li>Parameter: <code>min_feature_year</code></li>
</ul>
</li>
<li><strong>Outputs:</strong> <ul>
<li>Dataset: <code>final_unscaled_features</code> in the <code>data/03_feature/</code> folder</li>
</ul>
</li>
</ul>
<h3 id="step-8-final-scaled-features">Step 8: Final scaled features</h3>
<ul>
<li><strong>Function</strong>: <code>get_final_scaled_features()</code></li>
<li><strong>Purpose</strong>: Get the final scaled features to input into the modeling
pipeline. This applies the final preprocessor based on the "stationary guide."
For each feature, it takes the log of the feature if able (if not, it applies a
normalization). Finally, the preprocessor differences the feature until it is
stationary.</li>
<li><strong>Inputs</strong>: <ul>
<li>Dataset: <code>final_unscaled_features</code></li>
</ul>
</li>
<li><strong>Outputs:</strong> <ul>
<li>Dataset: <code>final_scaled_features</code> in the <code>data/03_feature/</code> folder</li>
</ul>
</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fac441b0.min.js"></script>
      
    
  </body>
</html>